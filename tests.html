<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <title>Tests</title>
  <meta http-equiv="content-type" content="text/html;charset=utf-8" />

  <link rel="stylesheet" href="bower_components/mocha/mocha.css" />
  <script type="text/javascript" src="bower_components/mocha/mocha.js"></script>

  <link rel="stylesheet" href="bower_components/mocha-screencast-reporter/screencast-reporter.css" />
  <script type="text/javascript" src="bower_components/mocha-screencast-reporter/screencast-reporter.js"></script>

  <script type="text/javascript">
    mocha.setup('bdd');
    mocha.reporter(ScreencastReporter);
  </script>

  <script type="text/javascript" src="bower_components/traceur/traceur.js"></script>
  <script type="text/javascript" src="bower_components/es6-module-loader/dist/es6-module-loader.js"></script>
  <script type="text/javascript" src="bower_components/system.js/dist/system.js"></script>

  <script type="text/javascript">
    window.onload = function() {
      System.map['char-buffer'] = 'bower_components/char-buffer/char-buffer';
      System.meta['char-buffer'] = { format: 'es6' };

      System.paths['chai'] = 'bower_components/chai/chai.js';

      System
        .import('lib/test/browser_tests')
        .then(function() {
          var runner = mocha.run(),
              count = 5,
              check;
          // check if ended (with workaround)
          check = setInterval(function(){
            if (runner.stats.end) {
              window.mochaResults = runner.stats;
              if(count>0){
                count--;
              }else{
                clearInterval(check);
              }
            }
          }, 1000);
        })
        .catch(function(e) {
          document.write(e);
          console.error(e);
          throw e;
        });
    };
  </script>
</head>
<body>
  <div id="mocha"></div>
</body>
</html>
